# 基于图的通用 **CAN** 总线异常检测系统

## 术语

ECU 电子控制单元

CAN总线 控制器局域网络总线：ECU与高级系统通信

注入攻击 通过无线或是有线的方法接入 CAN总线，以达到攻击的目的

* Dos拒绝服务

  暂缓攻击：在输送大量流量导致系统瘫痪的场景中，攻击者可以向 CAN 总线内部注入

  大量无意义的消息帧，例如 ID 为 000，数据全为 0 的消息。

  总线关闭攻击：发送可以导致系统瘫痪或崩溃的信息来实现此目的

* 模糊攻击

  通过提供无效、意外或是随机的消息帧作为 CAN 总线的注入负载，使得 CAN 总线中出现意外的干扰或是对其造成破坏。

* 冒充攻击

  通过冒充特定的 ECU，发送对应的信号来达到其目的。攻击者会首先断开某个特定的 ECU，并代替其发送相关 CAN ID 的消息帧。

* 重放攻击

  将有效数据传输或是合法的数据传输被恶意地重复或延迟发放。攻击者可以拦截合法的数据保存之后并在某一特定场景下重新传输。

CAN总线帧

CAN总线通信协议OSI

## 异常检测

异常检测主要的目的是检测出检测数据中的离群点，即

异常数值。比较直观的理解是当异常样本点与正常数据的特征值相差较大时，便

认为产生了异常样本。异常点主要可以分为三类：单点异常（Global Outliers）、上

下文异常 Contextual Outliers）和集体异常（Collective Outliers）

* [变分自编码器](https://cloud.tencent.com/developer/article/1096650)
* [VAE](https://blog.csdn.net/a312863063/article/details/87953517)
* [Pagerank算法](http://www.gwylab.com/note-vae.html) :Pagerank 相当于马尔可夫转移矩阵稳定后的矩阵实际值
* [KL散度](https://zhuanlan.zhihu.com/p/100676922)

### 预处理

从基于图的特征提取方法入手，将图中关于

时序和多重边的信息尽可能保留下来，并采用一个对正负样本数据集不存在较大

依赖的学习模型进行训练和分类检测



以基于图的特征提取方法为前提，将提取

出的 CAN 总线消息帧信息通过图搭建的方式，利用改进之后的 PageRank 算法保

留图中的时序信息和多重边信息，并采用生成模型的方法，通过考察其关于正类

样本特征的偏移程度判定是否存在异常行为的情况，满足了实用性、通用性和有

效性的保证，实现对 CAN 总线异常检测系统的多方面要求。







## 图处理

### 预处理

要采集汽车中 CAN 总线的消息帧日志信息作为初始数据。数据提取：提取CAN仲裁位ID，时间戳和数据。特征解析选用100条信息作为检测单元。

### 图生成

多重有向带权图，前后相邻序列中的can id作为一条有向边，时间戳差值作为边权。

### 压缩向量

将图结构压缩为可机器学习训练的向量，改进Pagerank算法，用CANrank算法对图的各个节点迭代，算出每个节点最终权序列，得到优先级向量

公式：应用指向该节点的边的权进行运算得到具体的优先级